<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
      integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
      crossorigin="anonymous"
    />
    <title>My Reading Challenge</title>
    <style>
        body {
          background-color: Cornsilk;
        }
        footer {
            background-color: tan;
            color: maroon;
        }
        header {
            background-color: tan;
        }
        h1 {
          text-align: center;
          color: maroon;
        }
    </style>
  </head>

  <body>
      <header>
      <h1>My Reading Challenge</h1>
      <hr />
      </header>
      <p>Use this random book generator to randomly grab a book from the New York Times Best Sellers in the Fiction Category. 
        You can click on the Amazon button to be taken to Amazon to purchase the book.
        Once you have read the book, click on read to add it to your challenge. Otherwise, click skip to generate another book recomendation.  
      </p>
      <hr />

      <div id="randomBook">

      </div>
      <button class="btn btn-success" id="read">Read</button>
      <button class="btn btn-secondary" id="skip">Skip</button>

      <div class="card">
        <div class="card-body" id="mainChallenge">
            <h2>Your goal is to read # books. You have read # so far.</h2>
            <div class="progress">
                <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" role="progressbar" style="width: 25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">challengeProgressPer</div>
            </div>
            <button type="button" class="btn btn-secondary" id="edit">Edit</button>
            <button type="button" class="btn btn-danger" id="startOver">Start Over</button>
        </div>
      </div>

    <footer>
        <hr />
        <h4>MIST7571E: Final Project</h4>
        <p>
          Created by: Angel Moore, Anita Lee, Avery Bray,
          <br />
          Jonathon Robinson, Lance Hunter, & Lauren Faulk
        </p>
    </footer>
  </body>

  <script>

    document.getElementById("edit").addEventListener("click",editChallenge);
    document.getElementById("startOver").addEventListener("click",reset);
    document.getElementById("read").addEventListener("click",addRead);
    document.getElementById("skip").addEventListener("click",skipBook);

    var challengeNumber = "5";
    var challengeProgressNum = 0;
    var challengeProgressPer = challengeProgressNum/challengeNumber;

    var bookStats;
    var bookTitle = "Book Title";
    var bookAuthor = "Avery Bray :)";
    var bookDesc = "Lorem Ipsum reihnd dsfkjv dfk vfjd kjfd mnfd nmfd vmn ,mfd ngfmndfnmgmnm, dfgmn m,nf bnmgm,cxf vjkf bmn hjfv fjb jfvnfjkg fn hf gjf bv fbnmf jh nfbmn f ";
    var bookCover = "https://images.unsplash.com/photo-1537495329792-41ae41ad3bf0?ixlib=rb-1.2.1&w=1000&q=80";
    var bookAmz = "https://www.amazon.com/Emptyful-Chair-Journeying-Mystical-Presence/dp/1950955265/ref=sr_1_2?dchild=1&qid=1594959839&refinements=p_27%3AAndrew+Harnack&s=books&sr=1-2&text=Andrew+Harnack";

    function editChallenge(){
      console.log(challengeProgressPer); //temp

      }

    function addRead(){
        challengeProgressNum = (challengeProgressNum + 1);
        console.log('New challengeProgressNum: ' + challengeProgressNum);
        skipBook();
    }

    function skipBook(){
        console.log("skipping to next book");
        bookApi();
        //innerhtml to load book on screenusing the vars set in bookApi;
    }

    function bookApi(){    
        async function api(r){
            let response = await fetch('https://api.nytimes.com/svc/books/v3/lists/combined-print-and-e-book-fiction.json?api-key=yKk5FpjwxMcg9EeAfjI2em6niAXP0GYb');
            let data = await response.json()
            return data.results.books[r];
        }

        // random number function based on value of books.length from api make it equal to r
        r=0; // remove once above is done

        //api(r).then(data => console.log(data.author));

        bookStats = api(r);
        console.log(bookStats); // need to resolve the promise to assign the value.

        //bookAuthor = bookStats.author;
        //console.log(bookAuthor);

    }

    function reset(){
        console.log("reset");
    }

  </script>
</html>